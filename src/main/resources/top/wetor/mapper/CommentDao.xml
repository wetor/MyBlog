<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.wetor.dao.CommentDao">

    <resultMap id="commentRM" type="top.wetor.domain.Comment">
        <id property="id" column="c_id"/>
        <result property="commentId" column="c_cid"/>
        <result property="articleId" column="a_id"/>
        <result property="time" column="c_time"/>
        <result property="name" column="c_name"/>
        <result property="mail" column="c_mail"/>
        <result property="content" column="c_content"/>
    </resultMap>


    <insert id="insertComment" parameterType="top.wetor.domain.Comment">
        insert into tb_comment
        values( null ,
            #{commentId},
            #{articleId},
            #{time},
            #{name},
            #{mail},
            #{content}
        )
    </insert>
    <delete id="deleteCommentById" parameterType="Integer">
        delete from tb_comment
        Where c_id = #{id}
    </delete>
    <update id="updateComment" parameterType="top.wetor.domain.Comment">
        update tb_comment
        <set>
            <if test="commentId!=null">c_cid=#{commentId},</if>
            <if test="articleId!=null">a_id=#{articleId},</if>
            <if test="time!=null">c_time=#{time},</if>
            <if test="name!=null">c_name=#{name},</if>
            <if test="mail!=null">a_id=#{mail},</if>
            <if test="content!=null">c_content=#{content},</if>
        </set>
        where c_id = #{id}
    </update>
    <select id="selectCommentById" parameterType="Integer" resultMap="commentRM">
        select * from tb_comment
        where c_id = #{id}
    </select>
    <select id="selectCommentCount" resultType="integer">
        select count(*) from tb_comment
    </select>
    <select id="selectCommentPage" resultMap="commentRM">
        select * from tb_comment
        where c_cid = null
        ORDER BY c_time
        <if test=" param3 == null or param3 == false ">
            desc
        </if>
        limit #{begin},#{number}
    </select>

    <select id="selectCommentAll" resultMap="commentRM">
        select * from tb_comment
        where c_cid = null
        ORDER BY c_time
        <if test=" param1 == null or param1 == false ">
            desc
        </if>
    </select>

    <select id="selectCommentReplyPageById" resultMap="commentRM">
        select * from tb_comment
        where c_cid=#{id}
        ORDER BY c_time
        <if test=" param4 == null or param4 == false ">
            desc
        </if>
        limit #{begin},#{number}
    </select>

    <select id="selectCommentReplyAllById" resultMap="commentRM">
        select * from tb_comment
        where c_cid=#{id}
        ORDER BY c_time
        <if test=" param2 == null or param2 == false ">
            desc
        </if>
    </select>

    <select id="selectArticleCommentAllById" resultMap="commentRM">
        select * from tb_comment
        where a_id=#{id} and c_cid=null
        ORDER BY c_time
        <if test=" param2 == null or param2 == false ">
            desc
        </if>
    </select>
</mapper>